{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shikai.ng\\\\Desktop\\\\ah2\\\\src\\\\Components\\\\PDFExportForm\\\\MaintenanceReport\\\\MaintenanceReport.js\";\nimport React from 'react';\nimport { Container, Row, Col, Button, Form } from 'react-bootstrap';\nimport PDFExporter from '../../../Helpers/PDFExporter/PDFExporter.js';\nimport { withRouter } from \"react-router-dom\";\nimport SpeechRecognition from \"react-speech-recognition\";\nimport SignatureCanvas from 'react-signature-canvas';\nimport './MaintenanceReport.css';\nimport { RenderForm } from '../../../Helpers/FormRenderer.js';\n\nclass MaintenanceReport extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.exporter = new PDFExporter();\n    this.sigCanvas = undefined;\n    this.recordIdHandling = undefined;\n    this.fieldHandling = undefined;\n\n    this.addRecord = () => {\n      let oldState = this.state;\n      oldState.records.push({\n        date: new Date(),\n        description: '',\n        remarks: ''\n      });\n      this.setState(oldState);\n    };\n\n    this.removeRecord = event => {\n      let id = event.target.dataset.id;\n      let oldState = this.state;\n      oldState.records.splice(id, 1);\n      this.setState(oldState);\n    };\n\n    this.JSDateToHTMLDateString = JSDate => {\n      var datestring = JSDate.getFullYear() + '-' + (\"0\" + (JSDate.getMonth() + 1)).slice(-2) + '-' + (\"0\" + JSDate.getDate()).slice(-2);\n      return datestring;\n    };\n\n    this.addMaintenanceReport = () => {\n      if (this.sigCanvas === undefined || this.sigCanvas.isEmpty()) {\n        alert(\"Please sign off\");\n      }\n\n      var curState = this.state;\n      curState.signature = this.sigCanvas.getTrimmedCanvas().toDataURL('image/png');\n      this.exporter.CreateMaintenanceReportPDF(curState, success => {\n        if (success) {\n          this.backToMaintenanceReportDash();\n        }\n      });\n    };\n\n    this.backToMaintenanceReportDash = () => {\n      this.props.history.push('/maintenance/report');\n    };\n\n    this.getDepartments = () => {\n      APIService.getDepts(depts => {\n        let oldState = this.state;\n\n        if (depts instanceof Array) {\n          oldState.deptNames = [];\n          depts.value.forEach(elm => {\n            oldState.deptNames.push({\n              label: elm,\n              value: elm\n            });\n          });\n        }\n\n        this.setState(oldState);\n      });\n    };\n\n    this.getVessels = () => {\n      APIService.getVessels(vessels => {\n        let oldState = this.state;\n\n        if (vessels instanceof Array) {\n          oldState.vesselNames = [];\n          vessels.value.forEach(elm => {\n            oldState.vesselNames.push({\n              label: elm.name,\n              value: elm.name\n            });\n          });\n        }\n\n        this.setState(oldState);\n      });\n    };\n\n    this.renderRecords = () => {\n      var recordElms = [];\n\n      for (var i = 0; i < this.state.records.length; i++) {\n        var record = this.state.records[i];\n        recordElms.push(React.createElement(Form.Row, {\n          key: i,\n          style: {\n            marginTop: '20px',\n            marginBottom: '20px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185\n          },\n          __self: this\n        }, React.createElement(Col, {\n          xs: 4,\n          sm: 0,\n          className: \"hide-on-sm\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }, React.createElement(Form.Label, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, \"Date\")), React.createElement(Col, {\n          xs: 8,\n          sm: 3,\n          className: \"verticalCenter\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }, React.createElement(Form.Control, {\n          type: \"date\",\n          min: \"1990\",\n          className: \"recordInput\",\n          \"data-id\": i,\n          \"data-datafield\": \"date\",\n          onChange: this.handleRecordChange.bind(this),\n          value: this.JSDateToHTMLDateString(record.date),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        })), React.createElement(Col, {\n          xs: 4,\n          sm: 0,\n          className: \"hide-on-sm\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, React.createElement(Form.Label, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, \"Description\")), React.createElement(Col, {\n          xs: 8,\n          sm: 5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, React.createElement(Form.Control, {\n          as: \"textarea\",\n          rows: \"3\",\n          \"data-id\": i,\n          onBlur: this.handleRecordBlur.bind(this),\n          onFocus: this.handleRecordFocus.bind(this),\n          className: \"recordInput\",\n          \"data-datafield\": \"description\",\n          onChange: this.decoratorHandleDataChange.bind(this),\n          value: record.description,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        })), React.createElement(Col, {\n          xs: 4,\n          sm: 0,\n          className: \"hide-on-sm\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        }, React.createElement(Form.Label, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }, \"Remarks\")), React.createElement(Col, {\n          xs: 8,\n          sm: 3,\n          className: \"verticalCenter\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, React.createElement(Form.Control, {\n          type: \"textarea\",\n          className: \"recordInput\",\n          \"data-id\": i,\n          \"data-datafield\": \"remarks\",\n          onBlur: this.handleRecordBlur.bind(this),\n          onFocus: this.handleRecordFocus.bind(this),\n          onChange: this.decoratorHandleDataChange.bind(this),\n          value: record.remarks,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        })), React.createElement(Col, {\n          xs: {\n            span: 1,\n            offset: 11\n          },\n          sm: {\n            span: 1,\n            offset: 0\n          },\n          style: {\n            textAlign: 'center',\n            marginTop: 'auto',\n            marginBottom: 'auto'\n          },\n          className: \"exta-top-margin-on-small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, React.createElement(Button, {\n          \"data-id\": i,\n          variant: \"danger\",\n          style: {\n            padding: '0 .4rem'\n          },\n          onClick: this.removeRecord,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }, \"x\"))));\n      }\n\n      return recordElms;\n    };\n\n    this.state = {\n      vessel: \"ASIAN HERCULES II\",\n      dept: \"KOMDIGI\",\n      month: \"OCTOBER\",\n      year: 2019,\n      records: [{\n        date: new Date(),\n        description: 'Completed created draft of report',\n        remarks: 'Good Job'\n      }],\n      vesselNames: [],\n      deptNames: [],\n      signature: undefined\n    };\n  }\n\n  componentDidMount() {\n    this.getVessels();\n    this.getDepartments();\n  } // MARK : Enable Speech to Text Entry of Input\n\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    let id = this.recordIdHandling;\n    let field = this.fieldHandling;\n\n    if (nextProps.transcript === \"\" || nextProps.transcript === this.props.transcript) {\n      return;\n    }\n\n    if (id === undefined) {\n      this.handleDataChange(undefined, field, nextProps.transcript);\n    } else {\n      this.handleRecordChange(undefined, field, id, nextProps.transcript);\n    }\n  }\n\n  handleRecordFocus(event) {\n    this.fieldHandling = event.target.dataset.datafield;\n    this.recordIdHandling = event.target.dataset.id;\n    this.props.startListening();\n  }\n\n  handleRecordBlur(event) {\n    this.props.stopListening();\n  }\n\n  decoratorHandleDataChange(event) {\n    let field = event.target.dataset.datafield;\n    let id = event.target.dataset.id;\n    let val = event.target.value;\n\n    if (id === undefined) {\n      this.handleDataChange(undefined, field, val);\n    } else {\n      this.handleRecordChange(undefined, field, id, val);\n    }\n  }\n\n  handleDataChange(event, field = null, val = null) {\n    let oldState = this.state;\n\n    if (event !== undefined) {\n      field = event.target.dataset.datafield;\n      val = event.target.value;\n    }\n\n    switch (field) {\n      case \"vessel\":\n        oldState.vessel = val;\n        break;\n\n      case \"dept\":\n        oldState.dept = val;\n        break;\n\n      case \"month\":\n        oldState.month = val;\n        break;\n\n      case \"year\":\n        oldState.year = val;\n        break;\n\n      default:\n        break;\n    }\n\n    this.setState(oldState);\n  }\n\n  handleRecordChange(event, field = null, id = null, val = null) {\n    if (event !== undefined) {\n      field = event.target.dataset.datafield;\n      id = event.target.dataset.id;\n      val = event.target.value;\n    }\n\n    let oldState = this.state;\n\n    switch (field) {\n      case \"date\":\n        oldState.records[id].date = new Date(val);\n        break;\n\n      case \"description\":\n        oldState.records[id].description = val;\n        break;\n\n      case \"remarks\":\n        oldState.records[id].remarks = val;\n        break;\n\n      default:\n        break;\n    }\n\n    this.setState(oldState);\n  }\n\n  render() {\n    var formDataTop = {\n      fields: [{\n        label: \"Vessel\",\n        value: this.state.vessel,\n        type: \"select\",\n        datafield: \"vessel\",\n        onChange: this.handleDataChange.bind(this),\n        options: this.state.vesselNames\n      }, {\n        label: \"Dept\",\n        value: this.state.dept,\n        type: \"select\",\n        datafield: \"dept\",\n        onChange: this.handleDataChange.bind(this),\n        options: this.state.deptNames\n      }, {\n        label: \"Month\",\n        value: this.state.month,\n        type: \"select\",\n        datafield: \"month\",\n        onChange: this.handleDataChange.bind(this),\n        options: [{\n          label: \"JANUARY\",\n          value: \"JANUARY\"\n        }, {\n          label: \"FEBRUARY\",\n          value: \"FEBRUARY\"\n        }, {\n          label: \"MARCH\",\n          value: \"MARCH\"\n        }, {\n          label: \"APRIL\",\n          value: \"APRIL\"\n        }, {\n          label: \"MAY\",\n          value: \"MAY\"\n        }, {\n          label: \"JUNE\",\n          value: \"JUNE\"\n        }, {\n          label: \"JULY\",\n          value: \"JULY\"\n        }, {\n          label: \"AUGUST\",\n          value: \"AUGUST\"\n        }, {\n          label: \"SEPTEMBER\",\n          value: \"SEPTEMBER\"\n        }, {\n          label: \"OCTOBER\",\n          value: \"OCTOBER\"\n        }, {\n          label: \"NOVEMBER\",\n          value: \"NOVEMBER\"\n        }, {\n          label: \"DECEMBER\",\n          value: \"DECEMBER\"\n        }]\n      }, {\n        label: \"Year\",\n        value: this.state.year,\n        type: \"number\",\n        datafield: \"year\",\n        onChange: this.handleDataChange.bind(this)\n      }]\n    };\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, React.createElement(Col, {\n      style: {\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"formHeader1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, \"Machinery Maintenance Report\"))), React.createElement(Row, {\n      className: \"formContents\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: 12,\n      sm: {\n        span: 10,\n        offset: 1\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, RenderForm(formDataTop), React.createElement(Form.Group, {\n      controlId: \"formRecords\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(Form.Row, {\n      style: {\n        marginTop: '40px',\n        marginBottom: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(Col, {\n      style: {\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, \"Records \"))), React.createElement(Form.Row, {\n      style: {\n        textAlign: \"center\",\n        fontSize: '1rem',\n        fontWeight: 600\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: 3,\n      className: \"hide-on-xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, \"Date\"), React.createElement(Col, {\n      xs: 5,\n      className: \"hide-on-xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, \"Description Of Maintenance Job Carried Out\"), React.createElement(Col, {\n      xs: 3,\n      className: \"hide-on-xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, \"Remarks \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }), \"(For Official Use)\"), React.createElement(Col, {\n      xs: {\n        span: 1,\n        offset: 11\n      },\n      sm: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, \" \", React.createElement(Button, {\n      variant: \"info\",\n      onClick: this.addRecord,\n      style: {\n        padding: '0 .4rem'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, \"+\"))), this.renderRecords()))), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: 12,\n      sm: {\n        span: 11\n      },\n      style: {\n        textAlign: \"right\",\n        marginTop: '30px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(SignatureCanvas, {\n      canvasProps: {\n        width: 300,\n        height: 100,\n        className: 'sigCanvas'\n      },\n      ref: ref => {\n        this.sigCanvas = ref;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }), \",\")), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: 12,\n      sm: {\n        span: 11\n      },\n      style: {\n        textAlign: \"right\",\n        marginTop: '30px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: this.backToMaintenanceReportDash,\n      style: {\n        marginRight: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, \"Back\"), React.createElement(Button, {\n      variant: \"primary\",\n      onClick: this.addMaintenanceReport,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"Save\"))), React.createElement(Row, {\n      style: {\n        paddingBottom: '50px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    })));\n  }\n\n}\n\nconst options = {\n  autoStart: false,\n  continuous: false\n};\nexport default SpeechRecognition(options)(withRouter(MaintenanceReport));","map":{"version":3,"sources":["C:/Users/shikai.ng/Desktop/ah2/src/Components/PDFExportForm/MaintenanceReport/MaintenanceReport.js"],"names":["React","Container","Row","Col","Button","Form","PDFExporter","withRouter","SpeechRecognition","SignatureCanvas","RenderForm","MaintenanceReport","Component","constructor","props","context","exporter","sigCanvas","undefined","recordIdHandling","fieldHandling","addRecord","oldState","state","records","push","date","Date","description","remarks","setState","removeRecord","event","id","target","dataset","splice","JSDateToHTMLDateString","JSDate","datestring","getFullYear","getMonth","slice","getDate","addMaintenanceReport","isEmpty","alert","curState","signature","getTrimmedCanvas","toDataURL","CreateMaintenanceReportPDF","success","backToMaintenanceReportDash","history","getDepartments","APIService","getDepts","depts","Array","deptNames","value","forEach","elm","label","getVessels","vessels","vesselNames","name","renderRecords","recordElms","i","length","record","marginTop","marginBottom","handleRecordChange","bind","handleRecordBlur","handleRecordFocus","decoratorHandleDataChange","span","offset","textAlign","padding","vessel","dept","month","year","componentDidMount","UNSAFE_componentWillReceiveProps","nextProps","field","transcript","handleDataChange","datafield","startListening","stopListening","val","render","formDataTop","fields","type","onChange","options","fontSize","fontWeight","width","height","className","ref","marginRight","paddingBottom","autoStart","continuous"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Container, Row, Col, Button, Form} from 'react-bootstrap'\r\nimport PDFExporter from '../../../Helpers/PDFExporter/PDFExporter.js'\r\nimport { withRouter } from \"react-router-dom\";\r\nimport SpeechRecognition from \"react-speech-recognition\";\r\nimport SignatureCanvas from 'react-signature-canvas'\r\n\r\nimport './MaintenanceReport.css'\r\nimport { RenderForm } from '../../../Helpers/FormRenderer.js';\r\nclass MaintenanceReport extends React.Component { \r\n    exporter = new PDFExporter()\r\n    sigCanvas = undefined\r\n    constructor(props, context) {\r\n        super(props, context)\r\n        this.state={ \r\n            vessel : \"ASIAN HERCULES II\",\r\n            dept : \"KOMDIGI\",\r\n            month : \"OCTOBER\",\r\n            year : 2019,\r\n            records : [\r\n                {\r\n                    date : new Date(),\r\n                    description : 'Completed created draft of report',\r\n                    remarks : 'Good Job'\r\n                }\r\n            ],\r\n            vesselNames : [],\r\n            deptNames : [],\r\n            signature : undefined\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        this.getVessels()\r\n        this.getDepartments()\r\n    }\r\n\r\n    // MARK : Enable Speech to Text Entry of Input\r\n    recordIdHandling = undefined\r\n    fieldHandling = undefined\r\n    UNSAFE_componentWillReceiveProps(nextProps) {\r\n        let id = this.recordIdHandling;\r\n        let field = this.fieldHandling;\r\n        if (nextProps.transcript === \"\" || nextProps.transcript === this.props.transcript) {\r\n            return\r\n        }\r\n        if (id === undefined) {\r\n            this.handleDataChange(undefined, field, nextProps.transcript)\r\n        } else {\r\n            this.handleRecordChange(undefined, field, id, nextProps.transcript)\r\n        }\r\n    }\r\n    handleRecordFocus(event) {\r\n        this.fieldHandling = event.target.dataset.datafield\r\n        this.recordIdHandling = event.target.dataset.id\r\n        this.props.startListening();\r\n    }\r\n    handleRecordBlur(event) {\r\n        this.props.stopListening();\r\n    }\r\n    decoratorHandleDataChange(event){\r\n        let field = event.target.dataset.datafield\r\n        let id = event.target.dataset.id\r\n        let val = event.target.value\r\n        if (id === undefined) {\r\n            this.handleDataChange(undefined, field, val)\r\n        } else {\r\n            this.handleRecordChange(undefined, field, id, val)\r\n        }\r\n    }\r\n\r\n    addRecord = () => {\r\n        let oldState = this.state\r\n        oldState.records.push({\r\n            date : new Date(),\r\n            description : '',\r\n            remarks : ''\r\n        })\r\n        this.setState(oldState) \r\n    }\r\n    removeRecord = (event) => {\r\n        let id = event.target.dataset.id;\r\n        let oldState = this.state\r\n        oldState.records.splice(id,1)\r\n        this.setState(oldState) \r\n    }\r\n    JSDateToHTMLDateString = (JSDate) => {\r\n        var datestring = JSDate.getFullYear()+'-'+ (\"0\"+(JSDate.getMonth()+1)).slice(-2) +'-'+ (\"0\" + JSDate.getDate()).slice(-2)\r\n        return datestring\r\n    }\r\n    addMaintenanceReport = () => {\r\n        if (this.sigCanvas === undefined || this.sigCanvas.isEmpty()) {\r\n            alert(\"Please sign off\")\r\n        }\r\n        var curState = this.state\r\n        curState.signature = this.sigCanvas.getTrimmedCanvas().toDataURL('image/png')\r\n        this.exporter.CreateMaintenanceReportPDF(curState, (success) => {\r\n            if (success) {\r\n                this.backToMaintenanceReportDash()\r\n            }\r\n        })\r\n    }\r\n    backToMaintenanceReportDash = () => {\r\n        this.props.history.push('/maintenance/report')\r\n    }\r\n\r\n    handleDataChange(event, field=null, val=null) {\r\n        let oldState = this.state;\r\n        if (event !== undefined) {\r\n            field = event.target.dataset.datafield\r\n            val = event.target.value\r\n        }\r\n        switch (field) {    \r\n            case \"vessel\" :\r\n                oldState.vessel = val\r\n                break\r\n            case \"dept\" :\r\n                oldState.dept = val\r\n                break\r\n            case \"month\" :\r\n                oldState.month = val\r\n                break\r\n            case \"year\" :\r\n                oldState.year = val\r\n                break\r\n            default :\r\n                break\r\n        }\r\n        this.setState(oldState)\r\n    }\r\n\r\n    handleRecordChange(event, field=null, id=null, val=null) {\r\n        if (event !== undefined) {\r\n            field = event.target.dataset.datafield\r\n            id = event.target.dataset.id\r\n            val = event.target.value\r\n        }\r\n        let oldState = this.state\r\n        switch (field) {    \r\n            case \"date\" :\r\n                oldState.records[id].date = new Date(val)\r\n                break\r\n            case \"description\" :\r\n                oldState.records[id].description = val\r\n                break\r\n            case \"remarks\" :\r\n                    oldState.records[id].remarks = val\r\n                break\r\n            default :\r\n                break\r\n        }\r\n        this.setState(oldState)\r\n    }\r\n\r\n    getDepartments = () => {\r\n        APIService.getDepts((depts) => {\r\n            let oldState = this.state\r\n            if (depts instanceof Array) {\r\n                oldState.deptNames = []\r\n                depts.value.forEach((elm) => {\r\n                    oldState.deptNames.push({label : elm, value : elm})\r\n                });\r\n            }\r\n            this.setState(oldState) \r\n        })\r\n    }\r\n    \r\n    getVessels = () => {\r\n        APIService.getVessels((vessels) => {\r\n            let oldState = this.state\r\n            if (vessels instanceof Array) {\r\n                oldState.vesselNames = []\r\n                vessels.value.forEach((elm) => {\r\n                    oldState.vesselNames.push({label : elm.name, value : elm.name})\r\n                });\r\n            }\r\n            this.setState(oldState) \r\n        })\r\n    } \r\n   \r\n    renderRecords = () => {\r\n        var recordElms = []\r\n        for (var i=0; i < this.state.records.length; i++) {\r\n            var record = this.state.records[i]\r\n            recordElms.push(\r\n                <Form.Row key={i} style={{marginTop : '20px', marginBottom : '20px'}}>\r\n                    <Col xs={4} sm={0} className=\"hide-on-sm\">\r\n                        <Form.Label>Date</Form.Label>\r\n                    </Col>\r\n                    <Col xs={8} sm={3} className=\"verticalCenter\">\r\n                        <Form.Control type=\"date\" min=\"1990\"\r\n                        className=\"recordInput\"\r\n                        data-id ={i}\r\n                        data-datafield =\"date\"\r\n                        onChange={this.handleRecordChange.bind(this)} value={this.JSDateToHTMLDateString(record.date)}></Form.Control>\r\n                    </Col>\r\n                    <Col xs={4} sm={0} className=\"hide-on-sm\">\r\n                        <Form.Label>Description</Form.Label>\r\n                    </Col>\r\n                    <Col xs={8} sm={5}>\r\n                        <Form.Control as=\"textarea\"\r\n                        rows=\"3\"\r\n                        data-id ={i}\r\n                        onBlur={this.handleRecordBlur.bind(this)}\r\n                        onFocus={this.handleRecordFocus.bind(this)}\r\n                        className=\"recordInput\"\r\n                        data-datafield =\"description\"\r\n                        onChange={this.decoratorHandleDataChange.bind(this)} value={record.description}></Form.Control>\r\n                    </Col>\r\n                    <Col xs={4} sm={0} className=\"hide-on-sm\">\r\n                        <Form.Label>Remarks</Form.Label>\r\n                    </Col>\r\n                    <Col xs={8} sm={3} className=\"verticalCenter\"> \r\n                        <Form.Control type=\"textarea\"\r\n                            className=\"recordInput\"\r\n                            data-id ={i}\r\n                            data-datafield =\"remarks\"\r\n                            onBlur={this.handleRecordBlur.bind(this)}\r\n                            onFocus={this.handleRecordFocus.bind(this)}\r\n                            onChange={this.decoratorHandleDataChange.bind(this)} value={record.remarks} />\r\n                    </Col>\r\n                    <Col xs={{span : 1, offset : 11}} sm={{span : 1, offset : 0}} \r\n                    style={{textAlign : 'center', marginTop : 'auto', marginBottom : 'auto'}}\r\n                    className=\"exta-top-margin-on-small\">\r\n                        <Button data-id ={i} variant='danger' \r\n                        style={{padding : '0 .4rem'}} \r\n                        onClick={this.removeRecord}>x</Button>\r\n                    </Col>\r\n                </Form.Row>\r\n            )\r\n        }\r\n        return recordElms\r\n    }\r\n    render() { \r\n        var formDataTop = {\r\n            fields : [{\r\n                label : \"Vessel\",\r\n                value : this.state.vessel,\r\n                type : \"select\",\r\n                datafield : \"vessel\",\r\n                onChange : this.handleDataChange.bind(this),\r\n                options : this.state.vesselNames\r\n            },{\r\n                label : \"Dept\",\r\n                value : this.state.dept,\r\n                type : \"select\",\r\n                datafield : \"dept\",\r\n                onChange : this.handleDataChange.bind(this),\r\n                options : this.state.deptNames\r\n            },{\r\n                label : \"Month\",\r\n                value : this.state.month,\r\n                type : \"select\",\r\n                datafield : \"month\",\r\n                onChange : this.handleDataChange.bind(this),\r\n                options : [\r\n                    {label : \"JANUARY\", value : \"JANUARY\"},\r\n                    {label : \"FEBRUARY\", value : \"FEBRUARY\"},\r\n                    {label : \"MARCH\", value : \"MARCH\"},\r\n                    {label : \"APRIL\", value : \"APRIL\"},\r\n                    {label : \"MAY\", value : \"MAY\"},\r\n                    {label : \"JUNE\", value : \"JUNE\"},\r\n                    {label : \"JULY\", value : \"JULY\"},\r\n                    {label : \"AUGUST\", value : \"AUGUST\"},\r\n                    {label : \"SEPTEMBER\", value : \"SEPTEMBER\"},\r\n                    {label : \"OCTOBER\", value : \"OCTOBER\"},\r\n                    {label : \"NOVEMBER\", value : \"NOVEMBER\"},\r\n                    {label : \"DECEMBER\", value : \"DECEMBER\"},\r\n                ]\r\n            },{\r\n                label : \"Year\",\r\n                value : this.state.year,\r\n                type : \"number\",\r\n                datafield : \"year\",\r\n                onChange : this.handleDataChange.bind(this),\r\n            }]\r\n        }\r\n        return (\r\n        <Container>\r\n            <Row>\r\n                <Col style={{textAlign : 'center'}} >\r\n                    <h1 className=\"formHeader1\">Machinery Maintenance Report</h1>\r\n                </Col>\r\n            </Row>\r\n            <Row className=\"formContents\">\r\n                 <Col xs={12} sm={{span : 10, offset : 1}}>\r\n                     {RenderForm(formDataTop)}\r\n                    <Form.Group controlId=\"formRecords\">\r\n                    <Form.Row style={{marginTop : '40px', marginBottom : '10px'}}>\r\n                        <Col style={{textAlign : 'center'}}>\r\n                            <h2>Records </h2>\r\n                        </Col>\r\n                    </Form.Row>\r\n                    <Form.Row style={{textAlign : \"center\", fontSize : '1rem', fontWeight : 600}}>\r\n                        <Col xs={3} className=\"hide-on-xs\">Date</Col>\r\n                        <Col xs={5} className=\"hide-on-xs\">Description Of Maintenance Job Carried Out</Col>\r\n                        <Col xs={3} className=\"hide-on-xs\">Remarks <br/>(For Official Use)</Col>\r\n                        <Col xs={{span : 1, offset : 11}} sm={1}> <Button variant='info' onClick={this.addRecord} style={{padding : '0 .4rem'}}>+</Button></Col>\r\n                    </Form.Row>\r\n                    {this.renderRecords()}\r\n                    </Form.Group>\r\n                 </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col xs={12} sm={{span : 11}} style={{textAlign : \"right\", marginTop : '30px'}}>\r\n                <SignatureCanvas \r\n                    canvasProps={{width: 300, height: 100, className: 'sigCanvas'}} \r\n                    ref={(ref) => { this.sigCanvas = ref }} />,\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col xs={12} sm={{span : 11}} style={{textAlign : \"right\", marginTop : '30px'}}>\r\n                    <Button variant=\"secondary\" onClick={this.backToMaintenanceReportDash} style={{marginRight : '10px'}}>Back</Button>\r\n                    <Button variant=\"primary\" onClick={this.addMaintenanceReport}>Save</Button>\r\n                </Col>\r\n            </Row>\r\n            <Row style={{paddingBottom : '50px'}}>\r\n                <Col>\r\n                </Col>\r\n            </Row>\r\n        </Container>\r\n    )}\r\n}\r\n\r\nconst options = {\r\n    autoStart: false,\r\n    continuous : false\r\n}\r\nexport default SpeechRecognition(options)(withRouter(MaintenanceReport));"]},"metadata":{},"sourceType":"module"}